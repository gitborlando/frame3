var a={element:"element",textNode:"textNode",component:"component"};var d={string:e=>Object.prototype.toString.call(e)==="[object String]",number:e=>Object.prototype.toString.call(e)==="[object Number]",boolean:e=>Object.prototype.toString.call(e)==="[object Boolean]",undefined:e=>Object.prototype.toString.call(e)==="[object Undefined]",null:e=>Object.prototype.toString.call(e)==="[object Null]",function:e=>Object.prototype.toString.call(e)==="[object Function]",object:e=>Object.prototype.toString.call(e)==="[object Object]",array:e=>Object.prototype.toString.call(e)==="[object Array]",multi(e,n){return n.split("|").some(t=>this[t.trim()]?.(e))}},c={component:e=>e?.type===a.component,element:e=>e?.type===a.element,textNode:e=>e?.type===a.textNode};function j(e){return function n(t){return new Proxy(t,{get(o,s){P(o,s);let l=Reflect.get(o,s);return typeof l=="object"?n(l):l},set(o,s,l){return Reflect.set(o,s,l),N(o,s),N(o,y),!0}})}({value:e})}function E(e){return e}var u,x=[],T=new WeakMap;function P(e,n){if(!u)return;if(d.array(e)){if(n==="length")return;n=n===y?n:"length"}T.get(e)||T.set(e,new Map);let t=T.get(e);t?.get(n)||t.set(n,new Set),u.shouldTrack&&t.get(n).add(u)}var y=Symbol("manual-track-object-key");function H(e){return P(e,y),e}function N(e,n){if(!e.hasOwnProperty(n)||n==="length")return;if(d.array(e)){if(n==="length")return;n=n===y?n:"length"}T.get(e)?.get(n)?.forEach(s=>{s!==u&&(s.scheduler?s.scheduler(s):s())})}function h(e,n){let t=Object.assign(()=>{try{x.push(u=t);let o=x.slice(-2,-1)[0];if(o&&!o.isFirstRun){u.shouldTrack=!1;return}e(n),u.isFirstRun=!1}finally{x.pop(),u=x.slice(-1)[0]}},{isFirstRun:!0,shouldTrack:!0,scheduler:n?.scheduler});t()}function R(e){let n=j("");return h(()=>n.value=e()),n}function B(e){return e()}function U(e){return j()}function A(e){return E()}function C(e,n){let{jsxTag:t,props:o,children:s}=e,l=e.componentInstance={isMounted:!1,props:o},i=t({...o,children:s});l.update=()=>{let r=i();r.children=V(r.children),l.isMounted?f(l.subVnode,r,n):(p(r,n),l.isMounted=!0),l.subVnode=r,e.el=r.el},l.passiveUpdate=(r,g)=>{i=t({...r,children:g}),l.props=r,l.update()},h(l.update,{scheduler:r=>Promise.resolve().then(r)}),o.hasOwnProperty("ref")&&(o.ref.value=l)}function M(e,n,t){n.componentInstance=e.componentInstance,!J(e.props,n.props)&&n.componentInstance.passiveUpdate(n.props,n.children)}function J(e,n){return Object.keys(n).every(t=>e[t]===n[t])}function F(e,n,t){if(m(e)||m(n)){if(m(e)&&m(n)&&(t.textContent=n.children[0].children[0]),m(e)&&!m(n))for(let o of n.children)p(o,t);!m(n)&&m(n)&&(I(e),t.textContent=n.children[0].children[0])}e.children[0].key&&n.children[0].key?q(e.children,n.children,t):W(e.children,n.children,t)}function m(e){return e.children.length<=1&&e.children[0]?.type===a.textNode}function W(e,n,t){let o=e.length,s=n.length,l=Math.min(o,s);for(let i=0;i<l;i++)f(e[i],n[i],t);if(s>o)return n.slice(l).forEach(i=>p(i,t));if(o>s)return e.slice(l).forEach(i=>I(i))}function q(e,n,t){let o=0,s=e.length-1,l=n.length-1;for(;o<=s&&o<=l&&k(e[o],n[o]);)f(e[o],n[o],t),o++;for(;o<=s&&o<=l&&k(e[s],n[l]);)f(e[o],n[o],t),s--,l--;if(console.log(o,s,l),o>s)for(let i=o;i<=l;i++)p(n[i],t);if(o>l)for(let i=o;i<=l;i++)I(e[i])}function k(e,n){return e.type===n.type&&e.key===n.key}function O(e,n){let t=document.createElement(e.jsxTag);n.appendChild(e.el=t),K(null,e,t);for(let o of e.children)p(o,t)}function S(e,n,t){let o=n.el=e.el;o&&(K(e,n,o),F(e,n,o))}function v(e,n){let t=document.createTextNode(e.children[0].toString());n.appendChild(e.el=t)}function L(e,n,t){let o=n.el=e.el;o&&(o.textContent=n.children[0].toString())}function K(e,n,t){let o=e?e.props:{},s=n.props,l=Object.entries(s).map(([i,r])=>i in o?o[i]!==r?[i,r]:void 0:[i,r]).filter(Boolean);for(let[i,r]of l)if(i.startsWith("on"))t.addEventListener(i.slice(2).toLocaleLowerCase(),r);else if(i==="style"){let g=Object.entries(r).map(([$,w])=>`${$}: ${w}`).join(";");t.setAttribute("style",g)}else i==="ref"?r.value=t:i==="className"?t.className=r:i==="scope-id"?t.setAttribute(`scope-${r}`,""):t.setAttribute(i,r)}function b(e,n={},t=[]){let o={props:n,children:t,el:null,componentInstance:null,key:n.key};return e===0?{type:a.textNode,jsxTag:e,...o}:d.string(e)?(o.children=V(o.children),{type:a.element,jsxTag:e,...o}):{type:a.component,jsxTag:e,...o}}function V(e){let n=[];return e.forEach(t=>{if(d.multi(t,"string|number"))return n.push(b(0,{},[t]));if(d.multi(t,"undefined|null"))return n.push(b(0,{},[""]));if(d.array(t))return n.push(...V(t));n.push(t)}),n}function p(e,n){if(c.component(e))return C(e,n);if(c.element(e))return O(e,n);if(c.textNode(e))return v(e,n)}function f(e,n,t){if(c.component(n)&&c.component(e))return M(e,n,t);if(c.element(n)&&c.element(e))return S(e,n,t);if(c.textNode(n)&&c.textNode(e))return L(e,n,t);I(e),p(n,t)}function I(e){c.component(e)&&e.componentInstance?I(e.componentInstance.subVnode):e.el?.remove()}function z(e,n){C(b(e,{},[]),n)}export{B as $computed,E as $reactive,A as $ref,R as computed,h as effect,b as h,H as manualTrack,z as mount,j as reactive,U as ref};
